<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto+Slab:300,300italic,400,400italic,700,700italic|PT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
<meta property="og:type" content="website">
<meta property="og:title" content="AndyJMR&#39;s Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="AndyJMR&#39;s Blog">
<meta property="og:description" content="不积跬步，无以至千里；不积小流，无以成江海。">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="AndyJMR">
<meta property="article:tag" content="C&#x2F;C++ OpenGL VTK ITK">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>AndyJMR's Blog</title>
  

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a735f8df830ee11dac6bfeec912328eb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">AndyJMR's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">AndyJMR</p>
  <div class="site-description" itemprop="description">不积跬步，无以至千里；不积小流，无以成江海。</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/AndyJMR" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AndyJMR" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/minmindianzi" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;minmindianzi" rel="noopener" target="_blank"><i class="fab fa-internet-explorer fa-fw"></i>CSDN</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/%E5%90%91%E9%87%8F%E7%82%B9%E4%B9%98%EF%BC%88%E5%86%85%E7%A7%AF%EF%BC%89%E5%92%8C%E5%8F%89%E4%B9%98%EF%BC%88%E5%A4%96%E7%A7%AF%E3%80%81%E5%90%91%E9%87%8F%E7%A7%AF%EF%BC%89%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/%E5%90%91%E9%87%8F%E7%82%B9%E4%B9%98%EF%BC%88%E5%86%85%E7%A7%AF%EF%BC%89%E5%92%8C%E5%8F%89%E4%B9%98%EF%BC%88%E5%A4%96%E7%A7%AF%E3%80%81%E5%90%91%E9%87%8F%E7%A7%AF%EF%BC%89%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-12-14 13:28:25" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2019-12-27 16:26:52" itemprop="dateModified" datetime="2019-12-27T16:26:52+08:00">2019-12-27</time>
      </span>

  
    <span id="/2020/12/14/%E5%90%91%E9%87%8F%E7%82%B9%E4%B9%98%EF%BC%88%E5%86%85%E7%A7%AF%EF%BC%89%E5%92%8C%E5%8F%89%E4%B9%98%EF%BC%88%E5%A4%96%E7%A7%AF%E3%80%81%E5%90%91%E9%87%8F%E7%A7%AF%EF%BC%89%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89/" class="post-meta-item leancloud_visitors" data-flag-title="" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/%E5%90%91%E9%87%8F%E7%82%B9%E4%B9%98%EF%BC%88%E5%86%85%E7%A7%AF%EF%BC%89%E5%92%8C%E5%8F%89%E4%B9%98%EF%BC%88%E5%A4%96%E7%A7%AF%E3%80%81%E5%90%91%E9%87%8F%E7%A7%AF%EF%BC%89%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/向量点乘（内积）和叉乘（外积、向量积）概念及几何意义/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <div class="article-copyright">
                    版权说明：本博客转载自                    https://blog.csdn.net/dcrmg/article/details/52416832    ，归原作者所有。            </div>                
<p><span style="font-size:18px;"><br></span></p>
<p><span style="font-size:18px;">向量是由n个实数组成的一个n行1列（n*1）或一个1行n列（1*n）的有序数组；</span></p>
<p><span style="font-size:18px;"><br></span></p>
<p><span style="font-size:18px;">向量的点乘,也叫向量的内积、数量积，对两个向量执行点乘运算，<span style="color:#ff0000;">就是对这两个向量对应位一一相乘之后求和的操作，点乘的结果是一个标量</span>。</span></p>
<p><span style="font-size:18px;"><br></span></p>
<h2><a name="t0"></a><span style="font-size:18px;">点乘公式</span></h2>
<div><span style="font-size:18px;"><br></span></div>
<p><span style="font-size:18px;">对于向量a和向量b：</span></p>
<p><span style="font-size:18px;"><br></span></p>
<p><span style="font-size:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="https://img-blog.csdn.net/20160902214136365" alt="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="https://img-blog.csdn.net/20160902214125943" alt=""><br></span></p>
<p><span style="font-size:18px;"><br></span></p>
<p><span style="font-size:18px;">a和b的点积公式为：</span></p>
<p><span style="font-size:18px;"><br></span></p>
<div style="text-align:center;"><img src="https://img-blog.csdn.net/20160902214456788" alt=""></div>
<div style="text-align:center;"><br></div>
<p></p>
<p><span style="font-size:18px;">要求一维向量a和向量b的行列数相同。</span></p>
<p><span style="font-size:18px;"><br></span></p>
<h2><a name="t1"></a><span style="font-size:18px;">点乘几何意义</span></h2>
<p><span style="font-size:18px;"><br></span></p>
<p><span style="font-size:18px;"><span style="color:#ff0000;">点乘的几何意义是可以用来表征或计算两个向量之间的夹角，以及在b向量在a向量方向上的投影</span>，有公式：</span></p>
<p><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902220238078" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">推导过程如下，首先看一下向量组成：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902222630016" alt=""><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">定义向量：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902222031821" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">根据三角形余弦定理有：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902222059055" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">根据关系c=a-b（a、b、c均为向量）有：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902222159946" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">即：</span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902222236837" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">向量a，b的长度都是可以计算的已知量，从而有a和b间的夹角θ：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902223248560" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><span style="color:#ff0000;">根据这个公式就可以计算向量a和向量b之间的夹角。从而就可以进一步判断这两个向量是否是同一方向，是否正交(也就是垂直)等方向关系</span>，具体对应关系为：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br>
&nbsp; &nbsp; &nbsp;a·b&gt;0 &nbsp; &nbsp;方向基本相同，夹角在0°到90°之间</span></p>
<p style="text-align:left;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp;a·b=0 &nbsp; &nbsp;正交，相互垂直 &nbsp;</span></p>
<p style="text-align:left;"><span style="font-size:18px;">&nbsp; &nbsp; &nbsp;a·b&lt;0 &nbsp; &nbsp;方向基本相反，夹角在90°到180°之间&nbsp;</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><strong><br></strong></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><strong>叉乘公式</strong></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">两个向量的叉乘，又叫向量积、外积、叉积，叉乘的运算结果是一个向量而不是一个标量。并且两个向量的叉积与这两个向量组成的坐标平面垂直。<br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">对于向量a和向量b：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902230539163" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">a和b的叉乘公式为：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902231520146" alt=""><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">其中：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902231657984" alt=""><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">根据i、j、k间关系，有：</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"></p>
<div style="text-align:center;"><img src="https://img-blog.csdn.net/20160902232255082" alt="" style="font-size:18px;"></div>
<div style="text-align:center;"><br></div>
<div style="text-align:center;"><br></div>
<h2><a name="t2"></a><span style="font-size:18px;"><strong>叉乘几何意义</strong></span></h2>
<p></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">在三维几何中，向量a和向量b的叉乘结果是一个向量，更为熟知的叫法是法向量，该向量垂直于a和b向量构成的平面。</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><span style="color:#ff0000;">在3D图像学中，叉乘的概念非常有用，可以通过两个向量的叉乘，生成第三个垂直于a，b的法向量，从而构建X、Y、Z坐标系。如下图所示：&nbsp;</span></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:center;"><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20160902232814429" alt=""></span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"><span style="font-size:18px;">在二维空间中，叉乘还有另外一个几何意义就是：aXb等于由向量a和向量b构成的平行四边形的面积。</span></p>
<p style="text-align:left;"><span style="font-size:18px;"><br></span></p>
<p style="text-align:left;"></p>
</div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/%E5%90%91%E9%87%8F%E5%8F%89%E7%A7%AF(Cross%20product)%E7%9A%84%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89%E5%8F%8A%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/%E5%90%91%E9%87%8F%E5%8F%89%E7%A7%AF(Cross%20product)%E7%9A%84%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89%E5%8F%8A%E5%BA%94%E7%94%A8/" class="post-title-link" itemprop="url">向量叉积(Cross product)的几何意义及应用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:44:58" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">计算机数学</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/%E5%90%91%E9%87%8F%E5%8F%89%E7%A7%AF(Cross%20product)%E7%9A%84%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89%E5%8F%8A%E5%BA%94%E7%94%A8/" class="post-meta-item leancloud_visitors" data-flag-title="向量叉积(Cross product)的几何意义及应用" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/%E5%90%91%E9%87%8F%E5%8F%89%E7%A7%AF(Cross%20product)%E7%9A%84%E5%87%A0%E4%BD%95%E6%84%8F%E4%B9%89%E5%8F%8A%E5%BA%94%E7%94%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/向量叉积(Cross product)的几何意义及应用/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="向量叉积"><a href="#向量叉积" class="headerlink" title="向量叉积"></a>向量叉积</h3><p><img src="https://img-blog.csdnimg.cn/20190824192822500.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="叉乘"><br>仅在三维空间，两个向量的叉积才有定义，记作 <strong>u</strong> ^ <strong>v</strong><br>定义为：<br>  <strong>u</strong> ^ <strong>v</strong> = ||<strong>u</strong>|| ||<strong>v</strong>|| sin(θ) <strong>n</strong><br>其中，θ表示<strong>u</strong> 和 <strong>v</strong> 的夹角， ||<strong>u</strong>|| 和 ||<strong>v</strong>|| 分别是向量 <strong>u</strong>和<strong>v</strong> 的模，<strong>n</strong> 则是<strong>u</strong>、<strong>v</strong> 所构成平面的法向（垂直于<strong>u</strong>、<strong>v</strong>平面的单位向量），方向由右手定则决定。</p>
<h3 id="矩阵表示"><a href="#矩阵表示" class="headerlink" title="矩阵表示"></a>矩阵表示</h3><p>叉积可以表示成如下行列式：<br><img src="https://img-blog.csdnimg.cn/2019082419592843.png" alt="在这里插入图片描述"><br>其中， <strong>u</strong> = (u1, u2, u3)，<strong>v</strong> = (v1, v2, v3)，<strong>i</strong>、<strong>j</strong>、<strong>k</strong>为基向量，为三维坐标系的x, y, z方向的单位向量。<br>这个行列式可以使用拉普拉斯在展开和萨吕法则计算。<br>使用拉普拉斯展开可以沿第一展开为：<br><img src="https://img-blog.csdnimg.cn/20190824200456188.png" alt="在这里插入图片描述"><br>使用萨吕法则可以展开为：<br><img src="https://img-blog.csdnimg.cn/20190824200532629.png" alt="在这里插入图片描述"></p>
<h3 id="几何意义"><a href="#几何意义" class="headerlink" title="几何意义"></a>几何意义</h3><p>根据定义可以得出，向量叉积的几何意义是以<strong>u</strong>和<strong>v</strong>为零边的平行四边形的有向面积。</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>在计算机图形学中，向量叉乘的应用广泛。比如，判断线段的相对位置，线段相交，点在多边形内，求凸包等。</p>
<h4 id="判断两条线段的相对位置"><a href="#判断两条线段的相对位置" class="headerlink" title="判断两条线段的相对位置"></a>判断两条线段的相对位置</h4><p><img src="https://img-blog.csdnimg.cn/20190824224332900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在二维平面上有两条线段，分别是AB和AC，如何通过向量叉积来确定他们的相对位置关系<br>点A、B、C的坐标为<br><img src="https://img-blog.csdnimg.cn/2019082611035115.png" alt="A(xa, Ya)"><br><img src="https://img-blog.csdnimg.cn/20190826110439827.png" alt="B(Xb, Yb)"><br><img src="https://img-blog.csdnimg.cn/20190826110453247.png" alt="P(Xp, Yp)"><br>首先构造两个向量AB和AC,<br><img src="https://img-blog.csdnimg.cn/2019082422440981.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由于二维空间不存在叉积的定义，所以引入z轴，将向量AB、AC扩展到三维空间，可以将二位向量可看作z轴恒为0的三维向量，<br>那么，两个向量叉积的则可表示为：<br><img src="https://img-blog.csdnimg.cn/20190826110046459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>res &gt; 0, AC在AB的逆时针方向<br>res = 0, AB和AC共线<br>res &lt; 0, AC在AB的顺时针方向</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E8%BD%B4%E5%AF%B9%E9%BD%90%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88AABB%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E8%BD%B4%E5%AF%B9%E9%BD%90%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88AABB%EF%BC%89/" class="post-title-link" itemprop="url">VTK笔记——轴对齐包围盒（AABB）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:48:17" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E8%BD%B4%E5%AF%B9%E9%BD%90%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88AABB%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——轴对齐包围盒（AABB）" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E8%BD%B4%E5%AF%B9%E9%BD%90%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88AABB%EF%BC%89/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——轴对齐包围盒（AABB）/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="什么是包围盒"><a href="#什么是包围盒" class="headerlink" title="什么是包围盒"></a>什么是包围盒</h2><p>包围盒是指能够包容物体的立方体或者二维长方形，是包围体的一种，常常用于模型的碰撞检测。包围体主要包括球体、<a target="_blank" rel="noopener" href="https://blog.csdn.net/minmindianzi/article/details/90897803">轴对齐包围盒(AABB)</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/minmindianzi/article/details/90903855">有向包围盒(OBB)</a>和凸包(Convex Hull)。<br>在较早的时候，包围盒按照坐标系的坐标轴进行排列，这被称为轴对齐的包围盒(AABB/Axis-aligned bounding box)。为了将AABB与通用的情况区分开来，将任意的包围盒称为有向包围盒(OBB/Oriented bounding box)。AABB检测模型的相交要比OBB更简单，但是他的缺点是当模型旋转的时候无法随之旋转，而必须重新计算。</p>
<h2 id="轴对齐包围盒"><a href="#轴对齐包围盒" class="headerlink" title="轴对齐包围盒"></a>轴对齐包围盒</h2><p>在VTK中，轴对齐包围盒被定义为包含该模型，且边平行于坐标轴的最小六面体。AABB比较简单，存储空间小，仅需六个标量。<br><strong>获取的标量</strong>也很简单，vtkPolyData中定义了GetBounds()函数，用来获取包围盒的参数，即三个轴向上的最大值和最小值。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkPolyData&gt; polydata =</span><br><span class="line">	vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line"><span class="keyword">double</span> bounds[<span class="number">6</span>];</span><br><span class="line">polydata-&gt;GetBounds(bounds);</span><br></pre></td></tr></table></figure>
<p>需要注意的是，通过reader或者source来的模型，需要先Update()；<br>而有时候仅仅是获取这些参数并不直观，还需要<br><strong>显示包围盒</strong>，vtkOutlineFilter提供了这一方便的操作，输入模型的数据，就很容易的可视化显示。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkOutlineFilter&gt; outline =</span><br><span class="line">	vtkSmartPointer&lt;vtkOutlineFilter&gt;::New();</span><br><span class="line">outline-&gt;SetInputData(polydata);</span><br><span class="line">outline-&gt;Update();</span><br></pre></td></tr></table></figure>
<p>Default Solid face is off, on:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outline-&gt;GenerateFacesOn();</span><br></pre></td></tr></table></figure>

<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="https://img-blog.csdnimg.cn/20190605134407585.gif" alt="cow"></p>
<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSmartPointer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyData.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSphereSource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkXMLPolyDataReader.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkActor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyDataMapper.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindow.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindowInteractor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkOutlineFilter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkProperty.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vtkSmartPointer&lt;vtkPolyData&gt; polydata =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">	<span class="keyword">if</span> (argc &gt; <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		vtkSmartPointer&lt;vtkXMLPolyDataReader&gt; reader =</span><br><span class="line">			vtkSmartPointer&lt;vtkXMLPolyDataReader&gt;::New();</span><br><span class="line">		reader-&gt;SetFileName(argv[<span class="number">1</span>]);</span><br><span class="line">		reader-&gt;Update();</span><br><span class="line">		polydata = reader-&gt;GetOutput();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		vtkSmartPointer&lt;vtkSphereSource&gt; modelSource =</span><br><span class="line">			vtkSmartPointer&lt;vtkSphereSource&gt;::New();</span><br><span class="line">		modelSource-&gt;Update();</span><br><span class="line">		polydata = modelSource-&gt;GetOutput();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkOutlineFilter&gt; outline =</span><br><span class="line">		vtkSmartPointer&lt;vtkOutlineFilter&gt;::New();</span><br><span class="line">	outline-&gt;SetInputData(polydata);</span><br><span class="line">	outline-&gt;Update();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> bounds[<span class="number">6</span>];</span><br><span class="line">	polydata-&gt;GetBounds(bounds);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Polydata bounds: &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;xmin: &quot;</span> &lt;&lt; bounds[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;xmax: &quot;</span> &lt;&lt; bounds[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;ymin: &quot;</span> &lt;&lt; bounds[<span class="number">2</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;ymax: &quot;</span> &lt;&lt; bounds[<span class="number">3</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;zmin: &quot;</span> &lt;&lt; bounds[<span class="number">4</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;zmax: &quot;</span> &lt;&lt; bounds[<span class="number">5</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	outline-&gt;GetOutput()-&gt;GetBounds(bounds);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Outline bounds: &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;xmin: &quot;</span> &lt;&lt; bounds[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;xmax: &quot;</span> &lt;&lt; bounds[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;ymin: &quot;</span> &lt;&lt; bounds[<span class="number">2</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;ymax: &quot;</span> &lt;&lt; bounds[<span class="number">3</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;zmin: &quot;</span> &lt;&lt; bounds[<span class="number">4</span>] &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">			  &lt;&lt; <span class="string">&quot;zmax: &quot;</span> &lt;&lt; bounds[<span class="number">5</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; modelMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	modelMapper-&gt;SetInputData(polydata);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; modelActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	modelActor-&gt;SetMapper(modelMapper);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; outlineMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	outlineMapper-&gt;SetInputConnection(outline-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; outlineActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	outlineActor-&gt;SetMapper(outlineMapper);</span><br><span class="line">	outlineActor-&gt;GetProperty()-&gt;SetColor(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	outlineActor-&gt;GetProperty()-&gt;SetLineWidth(<span class="number">1.5</span>);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkRenderer&gt; renderer =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindow&gt; renderWindow =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">	renderWindow-&gt;SetSize(<span class="number">300</span>, <span class="number">300</span>);</span><br><span class="line">	renderWindow-&gt;AddRenderer(renderer);</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindowInteractor&gt; renderWindowInteractor =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	renderWindowInteractor-&gt;SetRenderWindow(renderWindow);</span><br><span class="line"></span><br><span class="line">	renderer-&gt;AddActor(modelActor);</span><br><span class="line">	renderer-&gt;AddActor(outlineActor);</span><br><span class="line"></span><br><span class="line">	renderWindow-&gt;Render();</span><br><span class="line">	renderWindowInteractor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%85%E5%9B%B4%E4%BD%93">维基百科.包围体</a><br><a target="_blank" rel="noopener" href="https://vtk.org/Wiki/VTK/Examples/Cxx/PolyData/DataBounds">VTK/Examples/Cxx/PolyData/DataBounds</a></p>
<p><img src="https://img-blog.csdnimg.cn/20190605134455113.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="The End"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%9C%89%E5%90%91%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88OBB%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%9C%89%E5%90%91%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88OBB%EF%BC%89/" class="post-title-link" itemprop="url">VTK笔记——有向包围盒（OBB）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:48:06" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%9C%89%E5%90%91%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88OBB%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——有向包围盒（OBB）" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%9C%89%E5%90%91%E5%8C%85%E5%9B%B4%E7%9B%92%EF%BC%88OBB%EF%BC%89/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——有向包围盒（OBB）/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="什么是有向包围盒"><a href="#什么是有向包围盒" class="headerlink" title="什么是有向包围盒"></a>什么是有向包围盒</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/minmindianzi/article/details/90897803">《VTK笔记——轴对齐包围盒（AABB）》</a>提到了有向包围盒(OBB/Oriented bounding box)。<br>有向包围盒，是较为常用的包围盒类型。简单的说，它就是包围模型的最小盒子，是根据模型的几何形状来决定包围盒的大小和方向，无需和坐标轴垂直，方向是任意的，这是它的特点，但也导致了生成的复杂性。</p>
<h2 id="如何获取有向包围盒"><a href="#如何获取有向包围盒" class="headerlink" title="如何获取有向包围盒"></a>如何获取有向包围盒</h2><p>在VTK中，有一个算法类vtkOBBTree可以得到有向包围盒。它是一个Tree，为什么需要Tree？这是一种为了得到复杂模型的包围盒常用的一种方法，以一种更加专业的包围盒层次对模型进行分解。基本思路就是将模型组织成一个树状结构，根节点是整个模型，每个叶子节点包括一个简单的局部。<br><strong>Description</strong></p>
<blockquote>
<p>generate oriented bounding box (OBB) tree</p>
</blockquote>
<blockquote>
<p>vtkOBBTree is an object to generate oriented bounding box (OBB) trees. An oriented bounding box is a bounding box that does not necessarily line up along coordinate axes. The OBB tree is a hierarchical tree structure of such boxes, where deeper levels of OBB confine smaller regions of space.</p>
</blockquote>
<blockquote>
<p>To build the OBB, a recursive, top-down process is used. First, the root OBB is constructed by finding the mean and covariance matrix of the cells (and their points) that define the dataset. The eigenvectors of the covariance matrix are extracted, giving a set of three orthogonal vectors that define the tightest-fitting OBB. To create the two children OBB’s, a split plane is found that (approximately) divides the number cells in half. These are then assigned to the children OBB’s. This process then continues until the MaxLevel ivar limits the recursion, or no split plane can be found.</p>
</blockquote>
<blockquote>
<p>A good reference for OBB-trees is Gottschalk &amp; Manocha in Proceedings of Siggraph `96.</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> maxLevel = <span class="number">10</span>;</span><br><span class="line">vtkSmartPointer&lt;vtkOBBTree&gt; obbTree =</span><br><span class="line">	vtkSmartPointer&lt;vtkOBBTree&gt;::New();</span><br><span class="line">obbTree-&gt;SetDataSet(polydata);</span><br><span class="line">obbTree-&gt;SetMaxLevel(maxLevel);</span><br><span class="line">obbTree-&gt;BuildLocator();</span><br><span class="line"> </span><br><span class="line">vtkSmartPointer&lt;vtkPolyData&gt; obbPolydata =</span><br><span class="line">	vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">obbTree-&gt;GenerateRepresentation(<span class="number">0</span>, obbPolydata);</span><br></pre></td></tr></table></figure>
<p>SetMaxLevel设置Tree的最大层级，默认是8.<br>GenerateRepresentation用于获取指定层级的polydata.</p>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>整个模型的OBB<br><img src="https://img-blog.csdnimg.cn/20190605165744166.gif" alt="图1"><br>模型分层次的OBB<br><img src="https://img-blog.csdnimg.cn/20190605170005556.gif" alt="在这里插入图片描述"></p>
<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSmartPointer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyData.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSphereSource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkXMLPolyDataReader.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkActor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyDataMapper.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindow.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindowInteractor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkOBBTree.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkProperty.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkNamedColors.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vtkSmartPointer&lt;vtkNamedColors&gt; colors =</span><br><span class="line">		vtkSmartPointer&lt;vtkNamedColors&gt;::New();</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyData&gt; polydata =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">	<span class="keyword">if</span> (argc &gt; <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		vtkSmartPointer&lt;vtkXMLPolyDataReader&gt; reader =</span><br><span class="line">			vtkSmartPointer&lt;vtkXMLPolyDataReader&gt;::New();</span><br><span class="line">		reader-&gt;SetFileName(argv[<span class="number">1</span>]);</span><br><span class="line">		reader-&gt;Update();</span><br><span class="line">		polydata = reader-&gt;GetOutput();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		vtkSmartPointer&lt;vtkSphereSource&gt; modelSource =</span><br><span class="line">			vtkSmartPointer&lt;vtkSphereSource&gt;::New();</span><br><span class="line">		modelSource-&gt;Update();</span><br><span class="line">		polydata = modelSource-&gt;GetOutput();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> maxLevel = <span class="number">10</span>;</span><br><span class="line">	vtkSmartPointer&lt;vtkOBBTree&gt; obbTree =</span><br><span class="line">		vtkSmartPointer&lt;vtkOBBTree&gt;::New();</span><br><span class="line">	obbTree-&gt;SetDataSet(polydata);</span><br><span class="line">	obbTree-&gt;SetMaxLevel(maxLevel);</span><br><span class="line">	obbTree-&gt;BuildLocator();</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyData&gt; obbPolydata =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">	obbTree-&gt;GenerateRepresentation(<span class="number">0</span>, obbPolydata);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; modelMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	modelMapper-&gt;SetInputData(polydata);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; modelActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	modelActor-&gt;SetMapper(modelMapper);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; obbTreeMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	obbTreeMapper-&gt;SetInputData(obbPolydata);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; obbTreeActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	obbTreeActor-&gt;SetMapper(obbTreeMapper);</span><br><span class="line">	obbTreeActor-&gt;GetProperty()-&gt;SetInterpolationToFlat();</span><br><span class="line">	obbTreeActor-&gt;GetProperty()-&gt;SetOpacity(<span class="number">.5</span>);</span><br><span class="line">	obbTreeActor-&gt;GetProperty()-&gt;SetColor(</span><br><span class="line">		colors-&gt;GetColor4d(<span class="string">&quot;SpringGreen&quot;</span>).GetData());</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkRenderer&gt; renderer =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindow&gt; renderWindow =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">	renderWindow-&gt;SetSize(<span class="number">400</span>, <span class="number">400</span>);</span><br><span class="line">	renderWindow-&gt;AddRenderer(renderer);</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindowInteractor&gt; renderWindowInteractor =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	renderWindowInteractor-&gt;SetRenderWindow(renderWindow);</span><br><span class="line"></span><br><span class="line">	renderer-&gt;AddActor(modelActor);</span><br><span class="line">	renderer-&gt;AddActor(obbTreeActor);</span><br><span class="line"></span><br><span class="line">	renderWindow-&gt;Render();</span><br><span class="line">	renderWindowInteractor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkOBBTree.html#details">vtkOBBTree Class Reference</a><br><a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/DataStructures/VisualizeOBBTree/">VisualizeOBBTree</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lyggqm/p/5386174.html">[算法][包围盒]球，AABB，OBB</a><br><img src="https://img-blog.csdnimg.cn/20190605172453758.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E9%85%8D%E5%87%86%EF%BC%88Landmark%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E9%85%8D%E5%87%86%EF%BC%88Landmark%EF%BC%89/" class="post-title-link" itemprop="url">VTK笔记——医学图像配准（Landmark）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:58" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E9%85%8D%E5%87%86%EF%BC%88Landmark%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——医学图像配准（Landmark）" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E9%85%8D%E5%87%86%EF%BC%88Landmark%EF%BC%89/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——医学图像配准（Landmark）/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>随着现代医学的迅速发展，医学影像学为临床诊断提供了多种模态的医学图像，如X射线，CT，MRI等，当然，他们各自有各自的诊断优势。不过，有时候，医生希望将不同图像信息进行适当的集成。然而不同模态的医学图像成像原理不同，风辨率，成像参数却不相同，因此在图像融合前必须进行图像匹配。</p>
<p>医学图像配准就是通过寻找一种（或一系列）的空间变换（旋转、偏移、缩放和变形等），使两幅图像的对应点达到空间位置和解剖结构上的完全一致。配准结果应使两幅图像上是所有的解剖点（精确匹配），或至少是所有具有诊断意义的点都达到匹配（粗略匹配）。</p>
<p>其中，基于标记点对应关系的配准方法已经得到了广泛的应用，即所谓的特征匹配，通常用于图像分割、特征提取和关键点（landmark）搜寻等场合。</p>
<h2 id="vtkLandmarkTransform"><a href="#vtkLandmarkTransform" class="headerlink" title="vtkLandmarkTransform"></a>vtkLandmarkTransform</h2><p>vtkLandmarkTransform是一种比较经典的匹配算法，基于标记点，两个点集在配准后的平均距离最小，要求输入两个点数必须相等，序号一致的点集，做线性变换。它常用于粗略匹配，效率高。<br>下面简单的示范一下它是如何使用的？</p>
<p><strong>1.源标记点集</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkPoints&gt; sourcePoints =</span><br><span class="line">  vtkSmartPointer&lt;vtkPoints&gt;::New();</span><br><span class="line"><span class="keyword">double</span> sourcePoint1[<span class="number">3</span>] = &#123;<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">sourcePoints-&gt;InsertNextPoint(sourcePoint1);</span><br><span class="line"><span class="keyword">double</span> sourcePoint2[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">sourcePoints-&gt;InsertNextPoint(sourcePoint2);</span><br><span class="line"><span class="keyword">double</span> sourcePoint3[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>&#125;;</span><br><span class="line">sourcePoints-&gt;InsertNextPoint(sourcePoint3);</span><br></pre></td></tr></table></figure>
<p><strong>2.目标标记点集</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkPoints&gt; targetPoints =</span><br><span class="line">  vtkSmartPointer&lt;vtkPoints&gt;::New();</span><br><span class="line"><span class="keyword">double</span> targetPoint1[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.1</span>&#125;;</span><br><span class="line">targetPoints-&gt;InsertNextPoint(targetPoint1);</span><br><span class="line"><span class="keyword">double</span> targetPoint2[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">1.02</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">targetPoints-&gt;InsertNextPoint(targetPoint2);</span><br><span class="line"><span class="keyword">double</span> targetPoint3[<span class="number">3</span>] = &#123;<span class="number">-1.11</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">targetPoints-&gt;InsertNextPoint(targetPoint3);</span><br></pre></td></tr></table></figure>
<p><strong>3.设置Landmark</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkLandmarkTransform&gt; landmarkTransform = </span><br><span class="line">  vtkSmartPointer&lt;vtkLandmarkTransform&gt;::New();</span><br><span class="line">landmarkTransform-&gt;SetSourceLandmarks(sourcePoints);</span><br><span class="line">landmarkTransform-&gt;SetTargetLandmarks(targetPoints);</span><br><span class="line">landmarkTransform-&gt;SetModeToRigidBody();</span><br><span class="line">landmarkTransform-&gt;Update();</span><br></pre></td></tr></table></figure>
<p><strong>4.获取线性变换</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vtkMatrix4x4* mat = landmarkTransform-&gt;GetMatrix();</span><br></pre></td></tr></table></figure>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="https://img-blog.csdnimg.cn/20200108084002895.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="LandmarkTransform-cxx"><a href="#LandmarkTransform-cxx" class="headerlink" title="LandmarkTransform.cxx"></a>LandmarkTransform.cxx</h2> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPoints.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSmartPointer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkLandmarkTransform.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkMatrix4x4.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyDataMapper.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkActor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindow.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindowInteractor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkProperty.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkTransformPolyDataFilter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkVertexGlyphFilter.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">char</span> *[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  This demo creates a coordinate frame (+x, +y, +z) of vectors and a rotated,</span></span><br><span class="line"><span class="comment">  peturbed frame (+z, +y, -x) and aligns the rotated frame to the original as best as possible.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkPoints&gt; sourcePoints =</span><br><span class="line">    vtkSmartPointer&lt;vtkPoints&gt;::New();</span><br><span class="line">  <span class="keyword">double</span> sourcePoint1[<span class="number">3</span>] = &#123;<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">  sourcePoints-&gt;InsertNextPoint(sourcePoint1);</span><br><span class="line">  <span class="keyword">double</span> sourcePoint2[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">  sourcePoints-&gt;InsertNextPoint(sourcePoint2);</span><br><span class="line">  <span class="keyword">double</span> sourcePoint3[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>&#125;;</span><br><span class="line">  sourcePoints-&gt;InsertNextPoint(sourcePoint3);</span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkPoints&gt; targetPoints =</span><br><span class="line">    vtkSmartPointer&lt;vtkPoints&gt;::New();</span><br><span class="line">  <span class="keyword">double</span> targetPoint1[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.1</span>&#125;;</span><br><span class="line">  targetPoints-&gt;InsertNextPoint(targetPoint1);</span><br><span class="line">  <span class="keyword">double</span> targetPoint2[<span class="number">3</span>] = &#123;<span class="number">0.0</span>, <span class="number">1.02</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">  targetPoints-&gt;InsertNextPoint(targetPoint2);</span><br><span class="line">  <span class="keyword">double</span> targetPoint3[<span class="number">3</span>] = &#123;<span class="number">-1.11</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;;</span><br><span class="line">  targetPoints-&gt;InsertNextPoint(targetPoint3);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Setup the transform</span></span><br><span class="line">  vtkSmartPointer&lt;vtkLandmarkTransform&gt; landmarkTransform = </span><br><span class="line">    vtkSmartPointer&lt;vtkLandmarkTransform&gt;::New();</span><br><span class="line">  landmarkTransform-&gt;SetSourceLandmarks(sourcePoints);</span><br><span class="line">  landmarkTransform-&gt;SetTargetLandmarks(targetPoints);</span><br><span class="line">  landmarkTransform-&gt;SetModeToRigidBody();</span><br><span class="line">  landmarkTransform-&gt;Update(); <span class="comment">//should this be here?</span></span><br><span class="line"></span><br><span class="line">  vtkSmartPointer&lt;vtkPolyData&gt; source =</span><br><span class="line">    vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">  source-&gt;SetPoints(sourcePoints);</span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkPolyData&gt; target =</span><br><span class="line">    vtkSmartPointer&lt;vtkPolyData&gt;::New();</span><br><span class="line">  target-&gt;SetPoints(targetPoints);</span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkVertexGlyphFilter&gt; sourceGlyphFilter =</span><br><span class="line">    vtkSmartPointer&lt;vtkVertexGlyphFilter&gt;::New();</span><br><span class="line">  sourceGlyphFilter-&gt;SetInputData(source);</span><br><span class="line">  sourceGlyphFilter-&gt;Update();</span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkVertexGlyphFilter&gt; targetGlyphFilter =</span><br><span class="line">    vtkSmartPointer&lt;vtkVertexGlyphFilter&gt;::New();</span><br><span class="line">  targetGlyphFilter-&gt;SetInputData(target);</span><br><span class="line">  targetGlyphFilter-&gt;Update();</span><br><span class="line">    </span><br><span class="line">  vtkSmartPointer&lt;vtkTransformPolyDataFilter&gt; transformFilter =</span><br><span class="line">    vtkSmartPointer&lt;vtkTransformPolyDataFilter&gt;::New();</span><br><span class="line">  transformFilter-&gt;SetInputConnection(sourceGlyphFilter-&gt;GetOutputPort());</span><br><span class="line">  transformFilter-&gt;SetTransform(landmarkTransform);</span><br><span class="line">  transformFilter-&gt;Update();</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Display the transformation matrix that was computed</span></span><br><span class="line">  vtkMatrix4x4* mat = landmarkTransform-&gt;GetMatrix();</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Matrix: &quot;</span> &lt;&lt; *mat &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Visualize</span></span><br><span class="line">  vtkSmartPointer&lt;vtkPolyDataMapper&gt; sourceMapper =</span><br><span class="line">    vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">  sourceMapper-&gt;SetInputConnection(sourceGlyphFilter-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">  vtkSmartPointer&lt;vtkActor&gt; sourceActor =</span><br><span class="line">    vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">  sourceActor-&gt;SetMapper(sourceMapper);</span><br><span class="line">  sourceActor-&gt;GetProperty()-&gt;SetColor(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">  sourceActor-&gt;GetProperty()-&gt;SetPointSize(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">  vtkSmartPointer&lt;vtkPolyDataMapper&gt; targetMapper =</span><br><span class="line">    vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">  targetMapper-&gt;SetInputConnection(targetGlyphFilter-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">  vtkSmartPointer&lt;vtkActor&gt; targetActor =</span><br><span class="line">    vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">  targetActor-&gt;SetMapper(targetMapper);</span><br><span class="line">  targetActor-&gt;GetProperty()-&gt;SetColor(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  targetActor-&gt;GetProperty()-&gt;SetPointSize(<span class="number">4</span>);</span><br><span class="line">  </span><br><span class="line">  vtkSmartPointer&lt;vtkPolyDataMapper&gt; solutionMapper =</span><br><span class="line">    vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">  solutionMapper-&gt;SetInputConnection(transformFilter-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">  vtkSmartPointer&lt;vtkActor&gt; solutionActor =</span><br><span class="line">    vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">  solutionActor-&gt;SetMapper(solutionMapper);</span><br><span class="line">  solutionActor-&gt;GetProperty()-&gt;SetColor(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">  solutionActor-&gt;GetProperty()-&gt;SetPointSize(<span class="number">3</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Create a renderer, render window, and interactor</span></span><br><span class="line">  vtkSmartPointer&lt;vtkRenderer&gt; renderer =</span><br><span class="line">    vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">  vtkSmartPointer&lt;vtkRenderWindow&gt; renderWindow =</span><br><span class="line">    vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">  renderWindow-&gt;AddRenderer(renderer);</span><br><span class="line">  vtkSmartPointer&lt;vtkRenderWindowInteractor&gt; renderWindowInteractor =</span><br><span class="line">    vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">  renderWindowInteractor-&gt;SetRenderWindow(renderWindow);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Add the actor to the scene</span></span><br><span class="line">  renderer-&gt;AddActor(sourceActor);</span><br><span class="line">  renderer-&gt;AddActor(targetActor);</span><br><span class="line">  renderer-&gt;AddActor(solutionActor);</span><br><span class="line">  renderer-&gt;SetBackground(<span class="number">.3</span>, <span class="number">.6</span>, <span class="number">.3</span>); <span class="comment">// Background color green</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Render and interact</span></span><br><span class="line">  renderWindow-&gt;Render();</span><br><span class="line">  renderWindowInteractor-&gt;Start();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p> <a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/Filtering/LandmarkTransform/">VTKExamples/Cxx/Filtering/LandmarkTransform</a><br><img src="https://img-blog.csdnimg.cn/20200108084046881.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%AD%89%E5%80%BC%E9%9D%A2%E6%8F%90%E5%8F%96%EF%BC%88Marching%20Cubes%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%AD%89%E5%80%BC%E9%9D%A2%E6%8F%90%E5%8F%96%EF%BC%88Marching%20Cubes%EF%BC%89/" class="post-title-link" itemprop="url">VTK笔记——医学图像等值面提取（Marching Cubes）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:50" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%AD%89%E5%80%BC%E9%9D%A2%E6%8F%90%E5%8F%96%EF%BC%88Marching%20Cubes%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——医学图像等值面提取（Marching Cubes）" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%AD%89%E5%80%BC%E9%9D%A2%E6%8F%90%E5%8F%96%EF%BC%88Marching%20Cubes%EF%BC%89/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——医学图像等值面提取（Marching Cubes）/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="什么是等值面"><a href="#什么是等值面" class="headerlink" title="什么是等值面"></a>什么是等值面</h2><p>引用维基百科的解释：</p>
<blockquote>
<p>等值曲面是一种曲面。在空间里，假若，每一点都有一个设定的值。这值可能是压力、温度、速度、密度。那么，一个等值曲面所包含的每一个点，其设定值是一样的。换句话说，以三维空间为定义域的连续函数，其每一个水平集都是一个等值曲面。</p>
</blockquote>
<blockquote>
<p>应用计算机图形学，我们可以简易地显示出等值曲面的线框图或明暗图。在计算流体力学里，数据视觉化方法时常会用等值曲面来表示流体（液体或气体）流过物体时的瞬时状态。这是工程师研究发展新科技的一个利器。他们可以观察一个系统在任何时间的状态，从而发现其中奥秘。例如，等值曲面可以代表超音速飞行的单独震波。或者，我们可以制造几个等值曲面来代表，当空气流过飞机翅膀时，随着时间演变的一系列压力值。</p>
</blockquote>
<blockquote>
<p>面对着一大堆三维空间的数据，一个明智又受欢迎的选择，就是采用等值曲面为数据视觉化的主要形式。简单的多边形造型渲染的等值曲面，不需要用到很多的中央处理单元的资源，就能够迅速的计算出所要显示的图形。</p>
</blockquote>
<blockquote>
<p>在医学影像里，三维的电脑断层扫描用等值曲面来代表一个密度值区的部位。这样，我们可以将内部器官、骨头、等等，这些结构视觉化。</p>
</blockquote>
<p>简单的来说，我们可以使用等值面技术可视化感兴趣的区域，比如皮肤，骨骼等。</p>
<h2 id="等值面生成"><a href="#等值面生成" class="headerlink" title="等值面生成"></a>等值面生成</h2><p>等值面可视化的三种技术，体绘制，移动立方体（Marching Cubes）和部分立方体（Dividing Cubes）.<br>这篇笔记主要记录的是移动立方体（Marching Cubes）.</p>
<h2 id="Marching-Cubes的原理"><a href="#Marching-Cubes的原理" class="headerlink" title="Marching Cubes的原理"></a>Marching Cubes的原理</h2><blockquote>
<p>Marching Cubes（移动立方体）方法是由W.E.Lorenson和H.E.Cline在1987年提出来的。由于这一方法原理简单，易于实现，目前已经得到了较为广泛的应用，成为三维数据等值面生成的经典算法，Marching Cubes算法又简称为MC算法。</p>
</blockquote>
<blockquote>
<p>在Marching Cubes方法中，假定原始数据是离散的三维空间规则数据，一个体元定义为由相邻层上的8个顶点组成的一个长方体。为了在三维数据中构造等值面，应先给定所求等值面的值，该方法的基本原理是逐个处理所有的体元，将体元各顶点处的值与给定的阈值进行比较，首先找出与等值面相交的体元，然后通过插值求等值面与体元棱边的交点，并将各交点连成三角形来构成等值面片，所有体元中的三角形集合就构成了等值面。由于这一方法是逐个处理所有的体元，因此被称为Marching Cubes方法。</p>
</blockquote>
<p>关于Marching Cubes原理的详细解释。有兴趣可以参考Lorensen, W. E. and Cline, H. E., “<a target="_blank" rel="noopener" href="https://www.researchgate.net/publication/202232897_Marching_Cubes_A_High_Resolution_3D_Surface_Construction_Algorithm">Marching Cubes: A High Resolution 3D Surface Construction Algorithm</a>,” Computer Graphics, vol. 21, no. 3, pp. 163-169, July 1987.</p>
<h2 id="vtk实现类"><a href="#vtk实现类" class="headerlink" title="vtk实现类"></a>vtk实现类</h2><p>在vtk中实现Marching Cubes的算法类有很多，如vtkMarchingCubes,vtkSliceCubes,vtkMarchingSquares,vtkImageMarchingCubes等,它们是针对特定数据集类型而定义的。<br><strong>vtkMarchingCubes</strong><br>vtkMarchingCubes用于提取体数据。</p>
<blockquote>
<p>generate isosurface(s) from volume</p>
</blockquote>
<blockquote>
<p>vtkMarchingCubes is a filter that takes as input a volume (e.g., 3D structured point set) and generates on output one or more isosurfaces. One or more contour values must be specified to generate the isosurfaces. Alternatively, you can specify a min/max scalar range and the number of contours to generate a series of evenly spaced contour values.</p>
</blockquote>
<p><strong>vtkContourFilter</strong><br>vtkContourFilter根据特定的数据集类型自动创建一个最快的子类方法。</p>
<blockquote>
<p>generate isosurfaces/isolines from scalar values</p>
</blockquote>
<blockquote>
<p>vtkContourFilter is a filter that takes as input any dataset and generates on output isosurfaces and/or isolines. The exact form of the output depends upon the dimensionality of the input data. Data consisting of 3D cells will generate isosurfaces, data consisting of 2D cells will generate isolines, and data with 1D or 0D cells will generate isopoints. Combinations of output type are possible if the input dimension is mixed.</p>
</blockquote>
<blockquote>
<p>To use this filter you must specify one or more contour values. You can either use the method SetValue() to specify each contour value, or use GenerateValues() to generate a series of evenly spaced contours. It is also possible to accelerate the operation of this filter (at the cost of extra memory) by using a vtkScalarTree. A scalar tree is used to quickly locate cells that contain a contour surface. This is especially effective if multiple contours are being extracted. If you want to use a scalar tree, invoke the method UseScalarTreeOn().</p>
</blockquote>
<p>下面示例一个生成头部数据皮肤和骨骼的方法。<br><img src="https://img-blog.csdnimg.cn/20200119112210123.gif" alt="在这里插入图片描述"><br>The example uses <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lorensen/VTKExamples/master/src/Testing/Data/FullHead.mhd">FullHead.mhd</a> which references <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/lorensen/VTKExamples/master/src/Testing/Data/FullHead.mhd">FullHead.raw.gz</a>.</p>
<h2 id="MarchingCubes-cxx"><a href="#MarchingCubes-cxx" class="headerlink" title="MarchingCubes.cxx"></a>MarchingCubes.cxx</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkSmartPointer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkMetaImageReader.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkMarchingCubes.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkContourFilter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkStripper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkPolyDataNormals.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkPolyDataMapper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkActor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkProperty.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderWindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderWindowInteractor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkOutlineFilter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkNamedColors.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (argc &lt; <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; FullHead.mhd&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> colors = vtkSmartPointer&lt;vtkNamedColors&gt;::New();</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">char</span>, 4&gt; skinColor&#123; &#123;<span class="number">255</span>, <span class="number">125</span>, <span class="number">64</span>&#125; &#125;;</span><br><span class="line">	colors-&gt;SetColor(<span class="string">&quot;SkinColor&quot;</span>, skinColor.data());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> reader = vtkSmartPointer&lt;vtkMetaImageReader&gt;::New();</span><br><span class="line">	reader-&gt;SetFileName(argv[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 0</span></span><br><span class="line">	<span class="comment">// An isosurface, or contour value of 500 is known to correspond to the</span></span><br><span class="line">	<span class="comment">// skin of the patient.</span></span><br><span class="line">	<span class="keyword">auto</span> skinExtractor = vtkSmartPointer&lt;vtkMarchingCubes&gt;::New();</span><br><span class="line">	skinExtractor-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line">	skinExtractor-&gt;SetValue(<span class="number">0</span>, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// An isosurface, or contour value of 1150 is known to correspond to the</span></span><br><span class="line">	<span class="comment">// bone of the patient.</span></span><br><span class="line">	<span class="keyword">auto</span> boneExtractor = vtkSmartPointer&lt;vtkMarchingCubes&gt;::New();</span><br><span class="line">	boneExtractor-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line">	boneExtractor-&gt;SetValue(<span class="number">0</span>, <span class="number">1150</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The triangle stripper is used to create triangle strips from the</span></span><br><span class="line">	<span class="comment">// isosurface; these render much faster on may systems.</span></span><br><span class="line">	<span class="keyword">auto</span> skinStripper = vtkSmartPointer&lt;vtkStripper&gt;::New();</span><br><span class="line">	skinStripper-&gt;SetInputConnection(skinExtractor-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> boneStripper = vtkSmartPointer&lt;vtkStripper&gt;::New();</span><br><span class="line">	boneStripper-&gt;SetInputConnection(boneExtractor-&gt;GetOutputPort());</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">	<span class="comment">// An isosurface, or contour value of 500 is known to correspond to the</span></span><br><span class="line">	<span class="comment">// skin of the patient.</span></span><br><span class="line">	<span class="keyword">auto</span> skinExtractor = vtkSmartPointer&lt;vtkContourFilter&gt;::New();</span><br><span class="line">	skinExtractor-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line">	skinExtractor-&gt;SetValue(<span class="number">0</span>, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// An isosurface, or contour value of 1150 is known to correspond to the</span></span><br><span class="line">	<span class="comment">// bone of the patient.</span></span><br><span class="line">	<span class="keyword">auto</span> boneExtractor = vtkSmartPointer&lt;vtkContourFilter&gt;::New();</span><br><span class="line">	boneExtractor-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line">	boneExtractor-&gt;SetValue(<span class="number">0</span>, <span class="number">1150</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> skinNormals = vtkSmartPointer&lt;vtkPolyDataNormals&gt;::New();</span><br><span class="line">	skinNormals-&gt;SetInputConnection(skinExtractor-&gt;GetOutputPort());</span><br><span class="line">	skinNormals-&gt;SetFeatureAngle(<span class="number">60.0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> boneNormals = vtkSmartPointer&lt;vtkPolyDataNormals&gt;::New();</span><br><span class="line">	boneNormals-&gt;SetInputConnection(boneExtractor-&gt;GetOutputPort());</span><br><span class="line">	boneNormals-&gt;SetFeatureAngle(<span class="number">60.0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The triangle stripper is used to create triangle strips from the</span></span><br><span class="line">	<span class="comment">// isosurface; these render much faster on may systems.</span></span><br><span class="line">	<span class="keyword">auto</span> skinStripper = vtkSmartPointer&lt;vtkStripper&gt;::New();</span><br><span class="line">	skinStripper-&gt;SetInputConnection(skinNormals-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> boneStripper = vtkSmartPointer&lt;vtkStripper&gt;::New();</span><br><span class="line">	boneStripper-&gt;SetInputConnection(boneNormals-&gt;GetOutputPort());</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> skinMapper = vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	skinMapper-&gt;SetInputConnection(skinStripper-&gt;GetOutputPort());</span><br><span class="line">	skinMapper-&gt;ScalarVisibilityOff();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> boneMapper = vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	boneMapper-&gt;SetInputConnection(boneStripper-&gt;GetOutputPort());</span><br><span class="line">	boneMapper-&gt;ScalarVisibilityOff();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> skin = vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	skin-&gt;SetMapper(skinMapper);</span><br><span class="line">	skin-&gt;GetProperty()-&gt;SetDiffuseColor(colors-&gt;GetColor3d(<span class="string">&quot;SkinColor&quot;</span>).GetData());</span><br><span class="line">	skin-&gt;GetProperty()-&gt;SetSpecular(<span class="number">.3</span>);</span><br><span class="line">	skin-&gt;GetProperty()-&gt;SetSpecularPower(<span class="number">20</span>);</span><br><span class="line">	skin-&gt;GetProperty()-&gt;SetOpacity(<span class="number">.5</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> bone = vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	bone-&gt;SetMapper(boneMapper);</span><br><span class="line">	bone-&gt;GetProperty()-&gt;SetDiffuseColor(colors-&gt;GetColor3d(<span class="string">&quot;Ivory&quot;</span>).GetData());</span><br><span class="line"></span><br><span class="line">	<span class="comment">// An outline provides context around the data.</span></span><br><span class="line">	<span class="keyword">auto</span> outlineData = vtkSmartPointer&lt;vtkOutlineFilter&gt;::New();</span><br><span class="line">	outlineData-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> outlineMapper = vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	outlineMapper-&gt;SetInputConnection(outlineData-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> outline = vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	outline-&gt;SetMapper(outlineMapper);</span><br><span class="line">	outline-&gt;GetProperty()-&gt;SetColor(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> renderer = vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">	renderer-&gt;AddActor(skin);</span><br><span class="line">	renderer-&gt;AddActor(bone);</span><br><span class="line">	renderer-&gt;AddActor(outline);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> renWindow = vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">	renWindow-&gt;SetSize(<span class="number">640</span>, <span class="number">480</span>);</span><br><span class="line">	renWindow-&gt;AddRenderer(renderer);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> interactor = vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	interactor-&gt;SetRenderWindow(renWindow);</span><br><span class="line"></span><br><span class="line">	renWindow-&gt;Render();</span><br><span class="line">	interactor-&gt;Initialize();</span><br><span class="line">	interactor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%AD%89%E5%80%BC%E6%9B%B2%E9%9D%A2">等值曲面</a><br><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%AD%89%E5%80%BC%E9%9D%A2">等值面</a><br><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkMarchingCubes.html">vtkMarchingCubes Class Reference</a><br><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkContourFilter.html">vtkContourFilter Class Reference</a><br><a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/Medical/MedicalDemo2/">VTKExamples/Cxx/Medical/MedicalDemo2</a><br><a target="_blank" rel="noopener" href="http://www.cs.carleton.edu/cs_comps/0405/shape/marching_cubes.html">An Implementation of the Marching Cubes[1] Algorithm</a><br><img src="https://img-blog.csdnimg.cn/20200119112703319.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%88%87%E7%89%87%E6%8F%90%E5%8F%96(vtkImageReslice)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%88%87%E7%89%87%E6%8F%90%E5%8F%96(vtkImageReslice)/" class="post-title-link" itemprop="url">VTK笔记——医学图像的切片提取(vtkImageReslice)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:42" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%88%87%E7%89%87%E6%8F%90%E5%8F%96(vtkImageReslice)/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——医学图像的切片提取(vtkImageReslice)" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%88%87%E7%89%87%E6%8F%90%E5%8F%96(vtkImageReslice)/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——医学图像的切片提取(vtkImageReslice)/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>医学图像的浏览和内部分析是很常见也很重要的功能，我们不仅可以从矢状面、冠状面和轴状面这样的切面去看，还可以从任意切面去看。在VTK术语中，切面（切片）就是图像数据。</p>
<h2 id="vtkImageReslice"><a href="#vtkImageReslice" class="headerlink" title="vtkImageReslice"></a>vtkImageReslice</h2><p>vtkImageReslice，功能非常强大，有“瑞士军刀”的美誉。它不仅可以提取切片，还有图像旋转，翻转，重采样，变形等功能，并且效率还很高。这里只用到它的提取功能。<br><strong>切片提取</strong><br>切片提取的关键是要给出ResliceAxes，实际上，它是一个4X4的矩阵。我们可以这样来理解：把这个矩阵看作是新坐标系在原坐标下的坐标表示，一个齐次坐标系。前三列分别表示新坐标系下x、y、z的向量坐标，第四列表示新坐标系下原点的坐标。例如：<br>0,  0, -1, 6<br>1,  0,  0, 0<br>0, -1,  0, 0<br>0,  0,  0, 1<br>这个矩阵表示了在新坐标系下，x方向向量为（0, 1, 0），y方向向量为（0, 0, -1），z方向向量为（-1, 0, 0）和原点坐标为（6, 0, 0）矩阵。需要注意到是x, y, z三个向量要符合右手法则。<br>下面两种写法，作用一样：<br><strong>写法一：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> resliceAxes = vtkSmartPointer&lt;vtkMatrix4x4&gt;::New();</span><br><span class="line"><span class="keyword">auto</span> ImageReslice = vtkSmartPointer&lt;vtkImageReslice&gt;::New();</span><br><span class="line">ImageReslice-&gt;SetResliceAxes(resliceAxes);</span><br></pre></td></tr></table></figure>
<p><strong>写法二：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> x[<span class="number">3</span>] = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">double</span> y[<span class="number">3</span>] = &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">double</span> z[<span class="number">3</span>] = &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">double</span> origin[<span class="number">3</span>] = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125;;</span><br><span class="line">ImageReslice-&gt;SetResliceAxesDirectionCosines(x, y, z);</span><br><span class="line">ImageReslice-&gt;SetResliceAxesOrigin(origin);</span><br></pre></td></tr></table></figure>

<p>脑部CT图像<br><img src="https://img-blog.csdnimg.cn/20191212095550778.gif" alt="在这里插入图片描述"></p>
<h2 id="ResliceImage-cxx"><a href="#ResliceImage-cxx" class="headerlink" title="ResliceImage.cxx"></a>ResliceImage.cxx</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkSmartPointer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkMatrix4x4.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkDICOMImageReader.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageData.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageReslice.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkLookupTable.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageMapToColors.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageActor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageMapper3D.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderWindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderWindowInteractor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkInteractorStyleImage.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkCommand.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">vtkImageInteractionCallback</span> :</span> <span class="keyword">public</span> vtkCommand</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> vtkImageInteractionCallback* <span class="title">New</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> vtkImageInteractionCallback;</span><br><span class="line">	&#125;</span><br><span class="line">	vtkImageInteractionCallback()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;Slicing = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageReslice = <span class="literal">nullptr</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;Interactor = <span class="literal">nullptr</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetImageReslice</span><span class="params">(vtkImageReslice* reslice)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageReslice = reslice;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetMapToColors</span><span class="params">(vtkImageMapToColors* colors)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;MapToColors = colors;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetInteractor</span><span class="params">(vtkRenderWindowInteractor* interactor)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;Interactor = interactor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetRenderWindow</span><span class="params">(vtkRenderWindow* window)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;RenderWindow = window;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Execute</span><span class="params">(vtkObject* caller, <span class="keyword">unsigned</span> <span class="keyword">long</span> eventId, <span class="keyword">void</span>* callData)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> lastPos[<span class="number">2</span>], curPos[<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">this</span>-&gt;Interactor-&gt;GetLastEventPosition(lastPos);</span><br><span class="line">		<span class="keyword">this</span>-&gt;Interactor-&gt;GetEventPosition(curPos);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (eventId == vtkCommand::LeftButtonPressEvent)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slicing = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (eventId == vtkCommand::LeftButtonReleaseEvent)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slicing = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (eventId == vtkCommand::MouseMoveEvent)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;Slicing)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> deltaY = lastPos[<span class="number">1</span>] - curPos[<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">this</span>-&gt;ImageReslice-&gt;Update();</span><br><span class="line">				<span class="keyword">double</span> spacing = <span class="keyword">this</span>-&gt;ImageReslice-&gt;GetOutput()-&gt;GetSpacing()[<span class="number">2</span>];</span><br><span class="line">				vtkMatrix4x4* matrix = <span class="keyword">this</span>-&gt;ImageReslice-&gt;GetResliceAxes();</span><br><span class="line">				<span class="keyword">double</span> point[<span class="number">4</span>], center[<span class="number">4</span>];</span><br><span class="line">				point[<span class="number">0</span>] = <span class="number">0.0</span>;</span><br><span class="line">				point[<span class="number">1</span>] = <span class="number">0.0</span>;</span><br><span class="line">				point[<span class="number">2</span>] = spacing * deltaY;</span><br><span class="line">				point[<span class="number">3</span>] = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">				matrix-&gt;MultiplyPoint(point, center);</span><br><span class="line">				matrix-&gt;SetElement(<span class="number">0</span>, <span class="number">3</span>, center[<span class="number">0</span>]);</span><br><span class="line">				matrix-&gt;SetElement(<span class="number">1</span>, <span class="number">3</span>, center[<span class="number">1</span>]);</span><br><span class="line">				matrix-&gt;SetElement(<span class="number">2</span>, <span class="number">3</span>, center[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">this</span>-&gt;MapToColors-&gt;Update();</span><br><span class="line">				<span class="keyword">this</span>-&gt;OutputImageData = <span class="keyword">this</span>-&gt;MapToColors-&gt;GetOutput();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">this</span>-&gt;Interactor-&gt;Render();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				vtkInteractorStyle* style = vtkInteractorStyle::SafeDownCast(</span><br><span class="line">					<span class="keyword">this</span>-&gt;Interactor-&gt;GetInteractorStyle());</span><br><span class="line">				<span class="keyword">if</span> (style)</span><br><span class="line">					style-&gt;OnMouseMove();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> Slicing;</span><br><span class="line">	vtkImageReslice* ImageReslice;</span><br><span class="line">	vtkImageMapToColors* MapToColors;</span><br><span class="line">	vtkRenderWindowInteractor* Interactor;</span><br><span class="line">	vtkRenderWindow* RenderWindow;</span><br><span class="line">	vtkImageData* OutputImageData;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (argc &lt; <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; DicomDirectory&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> reader = vtkSmartPointer&lt;vtkDICOMImageReader&gt;::New();</span><br><span class="line">	reader-&gt;SetDirectoryName(argv[<span class="number">1</span>]);</span><br><span class="line">	reader-&gt;Update();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> extent[<span class="number">6</span>];</span><br><span class="line">	<span class="keyword">double</span> spacing[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">double</span> origin[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">double</span> center[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">	reader-&gt;GetOutput()-&gt;GetExtent(extent);</span><br><span class="line">	reader-&gt;GetOutput()-&gt;GetSpacing(spacing);</span><br><span class="line">	reader-&gt;GetOutput()-&gt;GetOrigin(origin);</span><br><span class="line"></span><br><span class="line">	center[<span class="number">0</span>] = origin[<span class="number">0</span>] + spacing[<span class="number">0</span>] * <span class="number">0.5</span> * (extent[<span class="number">0</span>] + extent[<span class="number">1</span>]);</span><br><span class="line">	center[<span class="number">1</span>] = origin[<span class="number">1</span>] + spacing[<span class="number">1</span>] * <span class="number">0.5</span> * (extent[<span class="number">2</span>] + extent[<span class="number">3</span>]);</span><br><span class="line">	center[<span class="number">2</span>] = origin[<span class="number">2</span>] + spacing[<span class="number">2</span>] * <span class="number">0.5</span> * (extent[<span class="number">4</span>] + extent[<span class="number">5</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">double</span> sagittalElements[<span class="number">16</span>] = &#123;</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>,<span class="number">-1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>,<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">double</span> cornalElements[<span class="number">16</span>] = &#123;</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">-1</span>,<span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">double</span> axialElements[<span class="number">16</span>] = &#123;</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">double</span> obliqueElements[<span class="number">16</span>] = &#123;</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0.866025</span>, <span class="number">-0.5</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0.5</span>, <span class="number">0.866025</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> resliceAxes = vtkSmartPointer&lt;vtkMatrix4x4&gt;::New();</span><br><span class="line">	resliceAxes-&gt;DeepCopy(axialElements);</span><br><span class="line">	resliceAxes-&gt;SetElement(<span class="number">0</span>, <span class="number">3</span>, center[<span class="number">0</span>]);</span><br><span class="line">	resliceAxes-&gt;SetElement(<span class="number">1</span>, <span class="number">3</span>, center[<span class="number">1</span>]);</span><br><span class="line">	resliceAxes-&gt;SetElement(<span class="number">2</span>, <span class="number">3</span>, center[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> x[<span class="number">3</span>] = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">double</span> y[<span class="number">3</span>] = &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">double</span> z[<span class="number">3</span>] = &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> ImageReslice = vtkSmartPointer&lt;vtkImageReslice&gt;::New();</span><br><span class="line">	ImageReslice-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line">	ImageReslice-&gt;SetOutputDimensionality(<span class="number">2</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 0</span></span><br><span class="line">	ImageReslice-&gt;SetResliceAxes(resliceAxes);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">	ImageReslice-&gt;SetResliceAxesDirectionCosines(x, y, z);</span><br><span class="line">	ImageReslice-&gt;SetResliceAxesOrigin(center);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ImageReslice-&gt;SetInterpolationModeToLinear();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> lookupTable = vtkSmartPointer&lt;vtkLookupTable&gt;::New();</span><br><span class="line">	lookupTable-&gt;SetRange(<span class="number">0</span>, <span class="number">2000</span>);</span><br><span class="line">	lookupTable-&gt;SetValueRange(<span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">	lookupTable-&gt;SetSaturationRange(<span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line">	lookupTable-&gt;SetRampToLinear();</span><br><span class="line">	lookupTable-&gt;Build();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> mapToColors = vtkSmartPointer&lt;vtkImageMapToColors&gt;::New();</span><br><span class="line">	mapToColors-&gt;SetLookupTable(lookupTable);</span><br><span class="line">	mapToColors-&gt;SetInputConnection(ImageReslice-&gt;GetOutputPort());</span><br><span class="line">	mapToColors-&gt;Update();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> imageActor = vtkSmartPointer&lt;vtkImageActor&gt;::New();</span><br><span class="line">	imageActor-&gt;GetMapper()-&gt;SetInputConnection(mapToColors-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> renderer = vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">	renderer-&gt;AddActor(imageActor);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> renderWindow = vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">	renderWindow-&gt;AddRenderer(renderer);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> imageStyle = vtkSmartPointer&lt;vtkInteractorStyleImage&gt;::New();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> interactor = vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	interactor-&gt;SetInteractorStyle(imageStyle);</span><br><span class="line">	interactor-&gt;SetRenderWindow(renderWindow);</span><br><span class="line">	interactor-&gt;Initialize();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> callback = vtkSmartPointer&lt;vtkImageInteractionCallback&gt;::New();</span><br><span class="line">	callback-&gt;SetImageReslice(ImageReslice);</span><br><span class="line">	callback-&gt;SetMapToColors(mapToColors);</span><br><span class="line">	callback-&gt;SetInteractor(interactor);</span><br><span class="line">	callback-&gt;SetRenderWindow(renderWindow);</span><br><span class="line"></span><br><span class="line">	imageStyle-&gt;AddObserver(vtkCommand::LeftButtonPressEvent, callback);</span><br><span class="line">	imageStyle-&gt;AddObserver(vtkCommand::LeftButtonReleaseEvent, callback);</span><br><span class="line">	imageStyle-&gt;AddObserver(vtkCommand::MouseMoveEvent, callback);</span><br><span class="line"></span><br><span class="line">	interactor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Example Download</p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkImageReslice.html#details">vtkImageReslice Class Reference</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/shenziheng1/article/details/54707462">VTK修炼之道26：图像基本操作_三维图像切片提取</a><br><img src="https://img-blog.csdnimg.cn/20191212095314979.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B8%8E%E4%BA%A4%E4%BA%92(vtkImageViewer2)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B8%8E%E4%BA%A4%E4%BA%92(vtkImageViewer2)/" class="post-title-link" itemprop="url">VTK笔记——医学图像的可视化与交互(vtkImageViewer2)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:34" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B8%8E%E4%BA%A4%E4%BA%92(vtkImageViewer2)/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——医学图像的可视化与交互(vtkImageViewer2)" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B8%8E%E4%BA%A4%E4%BA%92(vtkImageViewer2)/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——医学图像的可视化与交互(vtkImageViewer2)/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在读取了医学图像数据后，下一步就需要将它显示出来和进行交互操作。将3D的医学图像以2D的方式呈现，同时切换切片来帮助医学分析。</p>
<h2 id="vtkImageViewer2"><a href="#vtkImageViewer2" class="headerlink" title="vtkImageViewer2"></a>vtkImageViewer2</h2><p>一个方便易用的2D图像显示类，它封装了vtkRenderWindow, vtkRender, vtkImageActor和vtkImageMapToWinowLevelColors。同时，包含了一个vtkInteractorStyleImage的交互方式，使得显示和交互变得更加简单。</p>
<p>3D医学图像有很多，不仅只有CT，还有MRI，超声波，X-光等，各具有独特的诊断优势。下面以CT图像数据作为示例。<br><strong>读取数据</strong><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/minmindianzi/article/details/100853165">DICOM图像可以使用itk读取</a>，当然vtk也提供了读取类vtkDICOMImageReader。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> reader = vtkSmartPointer&lt;vtkDICOMImageReader&gt;::New();</span><br><span class="line">reader-&gt;SetDirectoryName(argv[<span class="number">1</span>]);</span><br><span class="line">reader-&gt;Update();</span><br></pre></td></tr></table></figure>
<p><strong>设置imageViewer</strong><br>可以设置slice，3维数据的方向，以及窗口大小、窗宽、窗位等等。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> imageViewer = vtkSmartPointer&lt;vtkImageViewer2&gt;::New();</span><br><span class="line">imageViewer-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> interactor = vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">imageViewer-&gt;SetupInteractor(interactor);</span><br><span class="line">imageViewer-&gt;SetSize(<span class="number">400</span>, <span class="number">400</span>);</span><br><span class="line">imageViewer-&gt;SetColorLevel(<span class="number">500</span>);</span><br><span class="line">imageViewer-&gt;SetColorWindow(<span class="number">1000</span>);</span><br><span class="line">imageViewer-&gt;SetSliceOrientationToXY(); <span class="comment">// z-axis</span></span><br><span class="line">imageViewer-&gt;GetRenderer()-&gt;SetBackground(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><strong>设置交互方式</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> myStyle = vtkSmartPointer&lt;myVtkInteractorStyleImage&gt;::New();</span><br><span class="line">myStyle-&gt;SetImageViewer(imageViewer);</span><br><span class="line">interactor-&gt;SetInteractorStyle(myStyle);</span><br></pre></td></tr></table></figure>
<h2 id="自定义交互方式"><a href="#自定义交互方式" class="headerlink" title="自定义交互方式"></a>自定义交互方式</h2><p>vtkInteractorStyleImage是默认方式，我们为了通过鼠标滚轮来切换slice，自定义如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myVtkInteractorStyleImage</span> :</span> <span class="keyword">public</span> vtkInteractorStyleImage</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> myVtkInteractorStyleImage* <span class="title">New</span><span class="params">()</span></span>;</span><br><span class="line">	vtkTypeMacro(myVtkInteractorStyleImage, vtkInteractorStyleImage);</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	vtkImageViewer2* ImageViewer;</span><br><span class="line">	<span class="keyword">int</span> Slice;</span><br><span class="line">	<span class="keyword">int</span> MinSlice;</span><br><span class="line">	<span class="keyword">int</span> MaxSlice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetImageViewer</span><span class="params">(vtkImageViewer2* imageViewer)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer = imageViewer;</span><br><span class="line">		<span class="keyword">this</span>-&gt;MinSlice = imageViewer-&gt;GetSliceMin();</span><br><span class="line">		<span class="keyword">this</span>-&gt;MaxSlice = imageViewer-&gt;GetSliceMax();</span><br><span class="line">		<span class="keyword">this</span>-&gt;Slice = (<span class="keyword">this</span>-&gt;MinSlice + <span class="keyword">this</span>-&gt;MaxSlice) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnMouseWheelForward</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;Slice &lt; <span class="keyword">this</span>-&gt;MaxSlice)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slice += <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnMouseWheelBackward</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;Slice &gt; <span class="keyword">this</span>-&gt;MinSlice)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slice -= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">vtkStandardNewMacro(myVtkInteractorStyleImage);</span><br></pre></td></tr></table></figure>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>脑部CT图像<br><img src="https://img-blog.csdnimg.cn/20191028114526447.gif" alt="在这里插入图片描述"></p>
<h2 id="DisplayDICOMSeries-cxx"><a href="#DisplayDICOMSeries-cxx" class="headerlink" title="DisplayDICOMSeries. cxx"></a>DisplayDICOMSeries. cxx</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkSmartPointer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkObjectFactory.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderWindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkGenericRenderWindowInteractor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkRenderer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkActor.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkDICOMImageReader.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkImageViewer2.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vtkInteractorStyleImage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myVtkInteractorStyleImage</span> :</span> <span class="keyword">public</span> vtkInteractorStyleImage</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> myVtkInteractorStyleImage* <span class="title">New</span><span class="params">()</span></span>;</span><br><span class="line">	vtkTypeMacro(myVtkInteractorStyleImage, vtkInteractorStyleImage);</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	vtkImageViewer2* ImageViewer;</span><br><span class="line">	<span class="keyword">int</span> Slice;</span><br><span class="line">	<span class="keyword">int</span> MinSlice;</span><br><span class="line">	<span class="keyword">int</span> MaxSlice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetImageViewer</span><span class="params">(vtkImageViewer2* imageViewer)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer = imageViewer;</span><br><span class="line">		<span class="keyword">this</span>-&gt;MinSlice = imageViewer-&gt;GetSliceMin();</span><br><span class="line">		<span class="keyword">this</span>-&gt;MaxSlice = imageViewer-&gt;GetSliceMax();</span><br><span class="line">		<span class="keyword">this</span>-&gt;Slice = (<span class="keyword">this</span>-&gt;MinSlice + <span class="keyword">this</span>-&gt;MaxSlice) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">		<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnMouseWheelForward</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;Slice &lt; <span class="keyword">this</span>-&gt;MaxSlice)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slice += <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnMouseWheelBackward</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>-&gt;Slice &gt; <span class="keyword">this</span>-&gt;MinSlice)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;Slice -= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;SetSlice(<span class="keyword">this</span>-&gt;Slice);</span><br><span class="line">			<span class="keyword">this</span>-&gt;ImageViewer-&gt;Render();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">vtkStandardNewMacro(myVtkInteractorStyleImage);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (argc &lt; <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; DicomDirectory&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> reader = vtkSmartPointer&lt;vtkDICOMImageReader&gt;::New();</span><br><span class="line">	reader-&gt;SetDirectoryName(argv[<span class="number">1</span>]);</span><br><span class="line">	reader-&gt;Update();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> imageViewer = vtkSmartPointer&lt;vtkImageViewer2&gt;::New();</span><br><span class="line">	imageViewer-&gt;SetInputConnection(reader-&gt;GetOutputPort());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> interactor = vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	imageViewer-&gt;SetupInteractor(interactor);</span><br><span class="line">	imageViewer-&gt;SetSize(<span class="number">400</span>, <span class="number">400</span>);</span><br><span class="line">	imageViewer-&gt;SetColorLevel(<span class="number">500</span>);</span><br><span class="line">	imageViewer-&gt;SetColorWindow(<span class="number">1000</span>);</span><br><span class="line">	imageViewer-&gt;SetSliceOrientationToXY();</span><br><span class="line">	imageViewer-&gt;GetRenderer()-&gt;SetBackground(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> myStyle = vtkSmartPointer&lt;myVtkInteractorStyleImage&gt;::New();</span><br><span class="line">	myStyle-&gt;SetImageViewer(imageViewer);</span><br><span class="line">	interactor-&gt;SetInteractorStyle(myStyle);</span><br><span class="line"></span><br><span class="line">	imageViewer-&gt;Render();</span><br><span class="line">	imageViewer-&gt;GetRenderer()-&gt;ResetCamera();</span><br><span class="line">	imageViewer-&gt;Render();</span><br><span class="line"></span><br><span class="line">	interactor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/AndyJMR/DisplayDICOMSeries"><strong>Example Download</strong></a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/IO/ReadDICOMSeries/">VTKExamples/Cxx/IO/ReadDICOMSeries</a><br><img src="https://img-blog.csdnimg.cn/20191030085400634.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8F%90%E5%8F%96%E8%BE%B9%E7%95%8C(vtkFeatureEdges)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8F%90%E5%8F%96%E8%BE%B9%E7%95%8C(vtkFeatureEdges)/" class="post-title-link" itemprop="url">VTK笔记——提取边界(vtkFeatureEdges)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:26" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8F%90%E5%8F%96%E8%BE%B9%E7%95%8C(vtkFeatureEdges)/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——提取边界(vtkFeatureEdges)" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8F%90%E5%8F%96%E8%BE%B9%E7%95%8C(vtkFeatureEdges)/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——提取边界(vtkFeatureEdges)/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>vtkFeatureEdges，VTK的一个类，用于边界提取。<br>提取的边界包括：<br>1)边界(boundary)，只被一个多边形使用的边，或者直线单元；<br>2)非流行(non-manifold)，被三个以上的多边形共用的边；<br>3)特征边(feature edges)，被两个三角形使用且二面角大于特征角的边；<br>4)流行边(manifold edges)，只被两个多边形使用的边。</p>
<h3 id="常用于"><a href="#常用于" class="headerlink" title="常用于"></a>常用于</h3><h4 id="1-提取模型的边界"><a href="#1-提取模型的边界" class="headerlink" title="1)提取模型的边界"></a>1)提取模型的边界</h4><p><img src="https://img-blog.csdnimg.cn/20190401172931378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkFeatureEdges&gt; boundaryEdges =</span><br><span class="line">	vtkSmartPointer&lt;vtkFeatureEdges&gt;::New();</span><br><span class="line">boundaryEdges-&gt;SetInputConnection(diskSource-&gt;GetOutputPort());</span><br><span class="line">boundaryEdges-&gt;BoundaryEdgesOn();</span><br><span class="line">boundaryEdges-&gt;FeatureEdgesOff();</span><br><span class="line">boundaryEdges-&gt;ManifoldEdgesOff();</span><br><span class="line">boundaryEdges-&gt;NonManifoldEdgesOff();</span><br><span class="line">boundaryEdges-&gt;Update();</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：提取出来的边界点是无序的，可以用vtkCleanPolyData使其变得有序：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkStripper&gt; stripper =</span><br><span class="line">	vtkSmartPointer&lt;vtkStripper&gt;::New();</span><br><span class="line">stripper-&gt;SetInputConnection(featureEdges-&gt;GetOutputPort());</span><br><span class="line">stripper-&gt;JoinContiguousSegmentsOn();</span><br><span class="line"></span><br><span class="line">vtkSmartPointer&lt;vtkCleanPolyData&gt; cleanPolyData =</span><br><span class="line">	vtkSmartPointer&lt;vtkCleanPolyData&gt;::New();</span><br><span class="line">cleanPolyData-&gt;SetInputConnection(stripper-&gt;GetOutputPort());</span><br><span class="line">cleanPolyData-&gt;Update();</span><br></pre></td></tr></table></figure>

<h4 id="2-检测模型是否闭合"><a href="#2-检测模型是否闭合" class="headerlink" title="2)检测模型是否闭合"></a>2)检测模型是否闭合</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vtkSmartPointer&lt;vtkFeatureEdges&gt; closedSurface =</span><br><span class="line">	vtkSmartPointer&lt;vtkFeatureEdges&gt;::New();</span><br><span class="line">closedSurface-&gt;SetInputConnection(diskSource-&gt;GetOutputPort());</span><br><span class="line">closedSurface-&gt;FeatureEdgesOff();</span><br><span class="line">closedSurface-&gt;BoundaryEdgesOn();</span><br><span class="line">closedSurface-&gt;NonManifoldEdgesOn();</span><br><span class="line">closedSurface-&gt;Update();</span><br><span class="line"><span class="keyword">int</span> numberOfOpenEdges = closedSurface-&gt;GetOutput()-&gt;GetNumberOfCells();</span><br><span class="line"><span class="keyword">if</span> (numberOfOpenEdges &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Surface is not closed&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Surface is closed&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSmartPointer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkFeatureEdges.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyData.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkDiskSource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPolyDataMapper.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkActor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindow.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindowInteractor.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">char</span> *[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vtkSmartPointer&lt;vtkDiskSource&gt; diskSource =</span><br><span class="line">		vtkSmartPointer&lt;vtkDiskSource&gt;::New();</span><br><span class="line">	diskSource-&gt;Update();</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkFeatureEdges&gt; boundaryEdges =</span><br><span class="line">		vtkSmartPointer&lt;vtkFeatureEdges&gt;::New();</span><br><span class="line">	boundaryEdges-&gt;SetInputConnection(diskSource-&gt;GetOutputPort());</span><br><span class="line">	boundaryEdges-&gt;BoundaryEdgesOn();</span><br><span class="line">	boundaryEdges-&gt;FeatureEdgesOff();</span><br><span class="line">	boundaryEdges-&gt;ManifoldEdgesOff();</span><br><span class="line">	boundaryEdges-&gt;NonManifoldEdgesOff();</span><br><span class="line">	boundaryEdges-&gt;Update();</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkFeatureEdges&gt; closedSurface =</span><br><span class="line">		vtkSmartPointer&lt;vtkFeatureEdges&gt;::New();</span><br><span class="line">	closedSurface-&gt;SetInputConnection(diskSource-&gt;GetOutputPort());</span><br><span class="line">	closedSurface-&gt;FeatureEdgesOff();</span><br><span class="line">	closedSurface-&gt;BoundaryEdgesOn();</span><br><span class="line">	closedSurface-&gt;NonManifoldEdgesOn();</span><br><span class="line">	closedSurface-&gt;Update();</span><br><span class="line">	<span class="keyword">int</span> numberOfOpenEdges = closedSurface-&gt;GetOutput()-&gt;GetNumberOfCells();</span><br><span class="line">	<span class="keyword">if</span> (numberOfOpenEdges &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Surface is not closed&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Surface is closed&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Visualize</span></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; edgeMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	edgeMapper-&gt;SetInputConnection(boundaryEdges-&gt;GetOutputPort());</span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; edgeActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	edgeActor-&gt;SetMapper(edgeMapper);</span><br><span class="line"></span><br><span class="line">	vtkSmartPointer&lt;vtkPolyDataMapper&gt; diskMapper =</span><br><span class="line">		vtkSmartPointer&lt;vtkPolyDataMapper&gt;::New();</span><br><span class="line">	diskMapper-&gt;SetInputConnection(diskSource-&gt;GetOutputPort());</span><br><span class="line">	vtkSmartPointer&lt;vtkActor&gt; diskActor =</span><br><span class="line">		vtkSmartPointer&lt;vtkActor&gt;::New();</span><br><span class="line">	diskActor-&gt;SetMapper(diskMapper);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Create a renderer, render window, and interactor</span></span><br><span class="line">	vtkSmartPointer&lt;vtkRenderer&gt; renderer =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderer&gt;::New();</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindow&gt; renderWindow =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindow&gt;::New();</span><br><span class="line">	renderWindow-&gt;SetSize(<span class="number">400</span>, <span class="number">400</span>);</span><br><span class="line">	renderWindow-&gt;AddRenderer(renderer);</span><br><span class="line">	vtkSmartPointer&lt;vtkRenderWindowInteractor&gt; renderWindowInteractor =</span><br><span class="line">		vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">	renderWindowInteractor-&gt;SetRenderWindow(renderWindow);</span><br><span class="line"></span><br><span class="line">	renderer-&gt;AddActor(edgeActor);</span><br><span class="line">	renderer-&gt;AddActor(diskActor);</span><br><span class="line">	renderer-&gt;SetBackground(<span class="number">.3</span>, <span class="number">.6</span>, <span class="number">.3</span>); <span class="comment">// Background color green</span></span><br><span class="line"></span><br><span class="line">	renderWindow-&gt;Render();</span><br><span class="line">	renderWindowInteractor-&gt;Start();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><p><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkFeatureEdges.html">vtkFeatureEdges Class Reference</a><br><a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/Meshes/BoundaryEdges/">BoundaryEdges</a><br><a target="_blank" rel="noopener" href="https://cmake.org/Wiki/VTK/Examples/Cxx/PolyData/ClosedSurface">ClosedSurface</a></p>
<p><img src="https://img-blog.csdnimg.cn/20190401173222525.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8B%BE%E5%8F%96%E5%99%A8Picker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="AndyJMR">
      <meta itemprop="description" content="不积跬步，无以至千里；不积小流，无以成江海。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AndyJMR's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8B%BE%E5%8F%96%E5%99%A8Picker/" class="post-title-link" itemprop="url">VTK笔记——拾取器Picker</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-12-14 13:28:25 / Modified: 14:47:17" itemprop="dateCreated datePublished" datetime="2020-12-14T13:28:25+08:00">2020-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VTK%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">VTK笔记</span></a>
        </span>
    </span>

  
    <span id="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8B%BE%E5%8F%96%E5%99%A8Picker/" class="post-meta-item leancloud_visitors" data-flag-title="VTK笔记——拾取器Picker" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/12/14/VTK%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%8B%BE%E5%8F%96%E5%99%A8Picker/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/14/VTK笔记——拾取器Picker/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>&#8195;&#8195;很多时候，医疗软件避免不了人机交互，而拾取器在人机交互中扮演着重要的角色，也是经常被用到，比如说，拾取点，拾取actor，拾取cell等等。</p>
<h2 id="拾取类"><a href="#拾取类" class="headerlink" title="拾取类"></a>拾取类</h2><p>VTK很强大，也很周到，提供了多种拾取类。<br><img src="https://img-blog.csdnimg.cn/20190913154219281.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="如何选择"><a href="#如何选择" class="headerlink" title="如何选择"></a>如何选择</h2><p>有时候选择太多也不是一件好事。那要怎样选择？我们得知道他们的区别。<br>简单的说，拾取器可分两类：<br>一类是基于硬件拾取，vtkPropPicker及其子类<br>另一类是基于几何拾取，vtkPicker和它的子类<br>硬件拾取的快速，但获取信息有限<br>几何拾取获得的信息多，但速度要慢一些</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>示例演示了通过鼠标移动在一个二维图像上拾取像素值，并判断是否在图像区域上。<br><img src="https://img-blog.csdnimg.cn/20190913203402914.gif" alt="在这里插入图片描述"></p>
<h2 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PickerType = vtkPropPicker; <span class="comment">// vtkPointPicker</span></span><br></pre></td></tr></table></figure>
<p>定义picker并初始化</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> picker = vtkSmartPointer&lt;PickerType&gt;::New();</span><br><span class="line">picker-&gt;PickFromListOn();</span><br></pre></td></tr></table></figure>
<p>添加拾取的Prop对象</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vtkImageActor* imageActor = imageViewer-&gt;GetImageActor();</span><br><span class="line">picker-&gt;AddPickList(imageActor);</span><br></pre></td></tr></table></figure>
<p>绑定自定义事件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> callback = vtkSmartPointer&lt;vtkImageInteractionCallback&gt;::New();</span><br><span class="line">callback-&gt;SetPicker(picker);</span><br></pre></td></tr></table></figure>
<p>获取世界坐标</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> pos[<span class="number">3</span>];</span><br><span class="line">picker-&gt;GetPickPosition(pos);</span><br></pre></td></tr></table></figure>

<p>值得注意：<br><strong>就上面的需求而言，这里应该选用vtkPropPicker，在vtk7.1.0中，可以拾取到坐标值，但在vtk8.2.0，不能获取到坐标，使用vtkPointPicker可以得到，目前原因未知。</strong></p>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkAssemblyPath.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkCell.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkCommand.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkCornerAnnotation.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkImageActor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkImageCast.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkImageData.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkImageNoiseSource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkImageViewer2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkInteractorStyleImage.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkMath.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPointData.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPropPicker.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkPointPicker.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkCellPicker.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindow.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderWindowInteractor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkRenderer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkSmartPointer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkTIFFReader.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vtkTextProperty.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> PickerType = vtkPointPicker;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Template for image value reading</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vtkValueMessageTemplate</span><span class="params">(vtkImageData* image, <span class="keyword">int</span>* position,</span></span></span><br><span class="line"><span class="function"><span class="params">                             <span class="built_in">std</span>::<span class="built_in">string</span>&amp; message)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  T* tuple = ((T*)image-&gt;GetScalarPointer(position));</span><br><span class="line">  <span class="keyword">int</span> components = image-&gt;GetNumberOfScalarComponents();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; components; ++c)</span><br><span class="line">  &#123;</span><br><span class="line">    message += vtkVariant(tuple[c]).ToString();</span><br><span class="line">    <span class="keyword">if</span> (c != (components - <span class="number">1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      message += <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  message += <span class="string">&quot; )&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The mouse motion callback, to pick the image and recover pixel values</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">vtkImageInteractionCallback</span> :</span> <span class="keyword">public</span> vtkCommand</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">static</span> vtkImageInteractionCallback* <span class="title">New</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> vtkImageInteractionCallback;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  vtkImageInteractionCallback()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Viewer = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Picker = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Annotation = <span class="literal">NULL</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~vtkImageInteractionCallback()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Viewer = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Picker = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Annotation = <span class="literal">NULL</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">SetPicker</span><span class="params">(PickerType* picker)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Picker = picker;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">SetAnnotation</span><span class="params">(vtkCornerAnnotation* annotation)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Annotation = annotation;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">SetViewer</span><span class="params">(vtkImageViewer2* viewer)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;Viewer = viewer;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Execute</span><span class="params">(vtkObject*, <span class="keyword">unsigned</span> <span class="keyword">long</span> vtkNotUsed(event), <span class="keyword">void</span>*)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    vtkRenderWindowInteractor* interactor =</span><br><span class="line">        <span class="keyword">this</span>-&gt;Viewer-&gt;GetRenderWindow()-&gt;GetInteractor();</span><br><span class="line">	<span class="keyword">int</span>* clickPos = interactor-&gt;GetEventPosition();</span><br><span class="line">    vtkRenderer* renderer = <span class="keyword">this</span>-&gt;Viewer-&gt;GetRenderer();</span><br><span class="line">	<span class="comment">//vtkRenderer* renderer = interactor-&gt;FindPokedRenderer(clickPos[0], clickPos[1]);</span></span><br><span class="line">    vtkImageActor* actor = <span class="keyword">this</span>-&gt;Viewer-&gt;GetImageActor();</span><br><span class="line">    vtkImageData* image = <span class="keyword">this</span>-&gt;Viewer-&gt;GetInput();</span><br><span class="line">    vtkInteractorStyle* style =</span><br><span class="line">        <span class="keyword">dynamic_cast</span>&lt;vtkInteractorStyle*&gt;(interactor-&gt;GetInteractorStyle());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Pick at the mouse location provided by the interactor</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;Picker-&gt;Pick(clickPos[<span class="number">0</span>], clickPos[<span class="number">1</span>], <span class="number">0.0</span>, renderer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// There could be other props assigned to this picker, so</span></span><br><span class="line">    <span class="comment">// make sure we picked the image actor</span></span><br><span class="line">    vtkAssemblyPath* path = <span class="keyword">this</span>-&gt;Picker-&gt;GetPath();</span><br><span class="line">    <span class="keyword">bool</span> validPick = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (path)</span><br><span class="line">    &#123;</span><br><span class="line">      vtkCollectionSimpleIterator sit;</span><br><span class="line">      path-&gt;InitTraversal(sit);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; path-&gt;GetNumberOfItems() &amp;&amp; !validPick; ++i)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">auto</span> node = path-&gt;GetNextNode(sit);</span><br><span class="line">        <span class="keyword">if</span> (actor == <span class="keyword">dynamic_cast</span>&lt;vtkImageActor*&gt;(node-&gt;GetViewProp()))</span><br><span class="line">        &#123;</span><br><span class="line">          validPick = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!validPick)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">this</span>-&gt;Annotation-&gt;SetText(<span class="number">0</span>, <span class="string">&quot;Off Image&quot;</span>);</span><br><span class="line">      interactor-&gt;Render();</span><br><span class="line">      <span class="comment">// Pass the event further on</span></span><br><span class="line">      style-&gt;OnMouseMove();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the world coordinates of the pick</span></span><br><span class="line">    <span class="keyword">double</span> pos[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">this</span>-&gt;Picker-&gt;GetPickPosition(pos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> image_coordinate[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> axis = <span class="keyword">this</span>-&gt;Viewer-&gt;GetSliceOrientation();</span><br><span class="line">    <span class="keyword">switch</span> (axis)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> vtkImageViewer2::SLICE_ORIENTATION_XZ:</span><br><span class="line">      image_coordinate[<span class="number">0</span>] = vtkMath::Round(pos[<span class="number">0</span>]);</span><br><span class="line">      image_coordinate[<span class="number">1</span>] = <span class="keyword">this</span>-&gt;Viewer-&gt;GetSlice();</span><br><span class="line">      image_coordinate[<span class="number">2</span>] = vtkMath::Round(pos[<span class="number">2</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> vtkImageViewer2::SLICE_ORIENTATION_YZ:</span><br><span class="line">      image_coordinate[<span class="number">0</span>] = <span class="keyword">this</span>-&gt;Viewer-&gt;GetSlice();</span><br><span class="line">      image_coordinate[<span class="number">1</span>] = vtkMath::Round(pos[<span class="number">1</span>]);</span><br><span class="line">      image_coordinate[<span class="number">2</span>] = vtkMath::Round(pos[<span class="number">2</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: <span class="comment">// vtkImageViewer2::SLICE_ORIENTATION_XY</span></span><br><span class="line">      image_coordinate[<span class="number">0</span>] = vtkMath::Round(pos[<span class="number">0</span>]);</span><br><span class="line">      image_coordinate[<span class="number">1</span>] = vtkMath::Round(pos[<span class="number">1</span>]);</span><br><span class="line">      image_coordinate[<span class="number">2</span>] = <span class="keyword">this</span>-&gt;Viewer-&gt;GetSlice();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Location: ( &quot;</span>;</span><br><span class="line">    message += vtkVariant(image_coordinate[<span class="number">0</span>]).ToString();</span><br><span class="line">    message += <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    message += vtkVariant(image_coordinate[<span class="number">1</span>]).ToString();</span><br><span class="line">    message += <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    message += vtkVariant(image_coordinate[<span class="number">2</span>]).ToString();</span><br><span class="line">    message += <span class="string">&quot; )\nValue: ( &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (image-&gt;GetScalarType())</span><br><span class="line">    &#123;</span><br><span class="line">      vtkTemplateMacro(</span><br><span class="line">          (vtkValueMessageTemplate&lt;VTK_TT&gt;(image, image_coordinate, message)));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;Annotation-&gt;SetText(<span class="number">0</span>, message.c_str());</span><br><span class="line">    interactor-&gt;Render();</span><br><span class="line">    style-&gt;OnMouseMove();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  vtkImageViewer2* Viewer;         <span class="comment">// Pointer to the viewer</span></span><br><span class="line">  PickerType* Picker;           <span class="comment">// Pointer to the picker</span></span><br><span class="line">  vtkCornerAnnotation* Annotation; <span class="comment">// Pointer to the annotation</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> imageViewer = vtkSmartPointer&lt;vtkImageViewer2&gt;::New();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Verify input arguments</span></span><br><span class="line">  <span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; Required parameters: (tif) Filename&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span></span><br><span class="line">              &lt;&lt; <span class="string">&quot;missing...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;A noise image will be created!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create a noise image</span></span><br><span class="line">    <span class="keyword">auto</span> noiseSource = vtkSmartPointer&lt;vtkImageNoiseSource&gt;::New();</span><br><span class="line">    noiseSource-&gt;SetWholeExtent(<span class="number">0</span>, <span class="number">512</span>, <span class="number">0</span>, <span class="number">512</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    noiseSource-&gt;SetMinimum(<span class="number">0.0</span>);</span><br><span class="line">    noiseSource-&gt;SetMaximum(<span class="number">65535.0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cast noise image to unsigned short</span></span><br><span class="line">    <span class="keyword">auto</span> imageCast = vtkSmartPointer&lt;vtkImageCast&gt;::New();</span><br><span class="line">    imageCast-&gt;SetInputConnection(noiseSource-&gt;GetOutputPort());</span><br><span class="line">    imageCast-&gt;SetOutputScalarTypeToUnsignedShort();</span><br><span class="line">    imageCast-&gt;Update();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// connect to image viewer pipeline</span></span><br><span class="line">    imageViewer-&gt;SetInputConnection(imageCast-&gt;GetOutputPort());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Parse input argument</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> inputFilename = argv[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read the image</span></span><br><span class="line">    <span class="keyword">auto</span> tiffReader = vtkSmartPointer&lt;vtkTIFFReader&gt;::New();</span><br><span class="line">    <span class="keyword">if</span> (!tiffReader-&gt;CanReadFile(inputFilename.c_str()))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot;: Error reading file &quot;</span> &lt;&lt; inputFilename</span><br><span class="line">                &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">      <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    tiffReader-&gt;SetFileName(inputFilename.c_str());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// connect to image viewer pipeline</span></span><br><span class="line">    imageViewer-&gt;SetInputConnection(tiffReader-&gt;GetOutputPort());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Picker to pick pixels</span></span><br><span class="line">  <span class="keyword">auto</span> picker = vtkSmartPointer&lt;PickerType&gt;::New();</span><br><span class="line">  picker-&gt;PickFromListOn();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Give the picker a prop to pick</span></span><br><span class="line">  vtkImageActor* imageActor = imageViewer-&gt;GetImageActor();</span><br><span class="line">  picker-&gt;AddPickList(imageActor);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// disable interpolation, so we can see each pixel</span></span><br><span class="line">  imageActor-&gt;InterpolateOff();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Visualize</span></span><br><span class="line">  <span class="keyword">auto</span> renderWindowInteractor =</span><br><span class="line">      vtkSmartPointer&lt;vtkRenderWindowInteractor&gt;::New();</span><br><span class="line">  imageViewer-&gt;SetupInteractor(renderWindowInteractor);</span><br><span class="line">  imageViewer-&gt;SetSize(<span class="number">600</span>, <span class="number">600</span>);</span><br><span class="line"></span><br><span class="line">  vtkRenderer* renderer = imageViewer-&gt;GetRenderer();</span><br><span class="line">  renderer-&gt;ResetCamera();</span><br><span class="line">  renderer-&gt;GradientBackgroundOn();</span><br><span class="line">  renderer-&gt;SetBackground(<span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0.5</span>);</span><br><span class="line">  renderer-&gt;SetBackground2(<span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Annotate the image with window/level and mouse over pixel</span></span><br><span class="line">  <span class="comment">// information</span></span><br><span class="line">  <span class="keyword">auto</span> cornerAnnotation = vtkSmartPointer&lt;vtkCornerAnnotation&gt;::New();</span><br><span class="line">  cornerAnnotation-&gt;SetLinearFontScaleFactor(<span class="number">2</span>);</span><br><span class="line">  cornerAnnotation-&gt;SetNonlinearFontScaleFactor(<span class="number">1</span>);</span><br><span class="line">  cornerAnnotation-&gt;SetMaximumFontSize(<span class="number">20</span>);</span><br><span class="line">  cornerAnnotation-&gt;SetText(<span class="number">0</span>, <span class="string">&quot;Off Image&quot;</span>);</span><br><span class="line">  cornerAnnotation-&gt;SetText(<span class="number">3</span>, <span class="string">&quot;&lt;window&gt;\n&lt;level&gt;&quot;</span>);</span><br><span class="line">  cornerAnnotation-&gt;GetTextProperty()-&gt;SetColor(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  imageViewer-&gt;GetRenderer()-&gt;AddViewProp(cornerAnnotation);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Callback listens to MouseMoveEvents invoked by the interactor&#x27;s style</span></span><br><span class="line">  <span class="keyword">auto</span> callback = vtkSmartPointer&lt;vtkImageInteractionCallback&gt;::New();</span><br><span class="line">  callback-&gt;SetViewer(imageViewer);</span><br><span class="line">  callback-&gt;SetAnnotation(cornerAnnotation);</span><br><span class="line">  callback-&gt;SetPicker(picker);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// InteractorStyleImage allows for the following controls:</span></span><br><span class="line">  <span class="comment">// 1) middle mouse + move = camera pan</span></span><br><span class="line">  <span class="comment">// 2) left mouse + move = window/level</span></span><br><span class="line">  <span class="comment">// 3) right mouse + move = camera zoom</span></span><br><span class="line">  <span class="comment">// 4) middle mouse wheel scroll = zoom</span></span><br><span class="line">  <span class="comment">// 5) &#x27;r&#x27; = reset window/level</span></span><br><span class="line">  <span class="comment">// 6) shift + &#x27;r&#x27; = reset camera</span></span><br><span class="line">  vtkInteractorStyleImage* imageStyle = imageViewer-&gt;GetInteractorStyle();</span><br><span class="line">  imageStyle-&gt;AddObserver(vtkCommand::MouseMoveEvent, callback);</span><br><span class="line"></span><br><span class="line">  renderWindowInteractor-&gt;Initialize();</span><br><span class="line">  renderWindowInteractor-&gt;Start();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/webzhuce/article/details/72802322">VTK交互之拾取</a><br><a target="_blank" rel="noopener" href="https://lorensen.github.io/VTKExamples/site/Cxx/Images/PickPixel2/">VTKExamples/Cxx/Images/PickPixel2</a><br><a target="_blank" rel="noopener" href="https://vtk.org/doc/nightly/html/classvtkAbstractPicker.html#details">vtkAbstractPicker Class Reference</a><br><img src="https://img-blog.csdnimg.cn/20190913204656180.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pbm1pbmRpYW56aQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AndyJMR</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  







  



<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      const visitors = document.querySelector('.leancloud_visitors');
      const url = decodeURI(visitors.id);
      const title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            const counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      const visitors = document.querySelectorAll('.leancloud_visitors');
      const entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            const target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    const { app_id, app_key, server_url } = {"enable":true,"app_id":"a2YE7UNG6CpOcQJ3T3PhTOKT-gzGzoHsz","app_key":"3ARwkw15puLjE9cLL4d6FLhI","server_url":null,"security":true,"visitor":false};
    function fetchData(api_server) {
      const Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    const api_server = app_id.slice(-9) === '-MdYXbMMI' ? `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com` : server_url;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>



<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://AndyJMR.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
